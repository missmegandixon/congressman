<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Whose congressman is that, anyway?</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://bootswatch.com/yeti/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  </head>

<!-- STYLE TO ADD TO A CSS FILE LATER -->
  <style>
  .jumbotron {
      background-color: #003057;
      color: #D0D3D4;
  }
  .container {
      background-color: #D0D3D4;
      color: #003057;
  }
  h3 {
    text-align: center;
  }
  </style>
<!-- END STYLES -->

  <body>

      <div class="jumbotron text-center">
        <h2> Whose Congressman is That, Anyway?</h2>
      </div>
        <div class="container">
          <div class="row">
            <div id="question" class="col-md-6">
              <img align="center" width="150" height="108" src="http://lovelace-media.imgix.net/uploads/25/378bc2a0-4376-0133-9d86-0af7184f89fb.gif" class="img-circle" alt="Trump">
              Loading...
            </div>
            <div id="answer" class="col-md-6">
             <h3>Guess</h3>
           </div>
         </div>
       </div>


    <hr/>
    <pre id="debug">
      Loading...
    </pre>

   <script type="text/javascript">
      var congressmenCount, congressmenData;

      function newQuestion() {
        var randomIndex = Math.floor(Math.random() * (congressmenCount - 1));
        console.log(randomIndex);
        var c = congressmenData[randomIndex];
        var q = $("<img src='"+c.headshot+"' />");
        var a = c.description;
        $("#question").html(q);
        $("#answer").html(a);
      }

      function fetchCongressmen(limit) {
        $.get("https://www.govtrack.us/api/v2/role?current=true&limit="+limit+"&role_type=representative&fields=id,person__bioguideid,party,person__name,person__youtubeid,state,website,description,person__link",
         function(data) {
          // store the congressmen
          congressmenCount = data.meta.total_count;
          congressmenData = data.objects;

          // display for easy debugging
          $("#debug").text(JSON.stringify(congressmenData));

          // fetch their headshots
          congressmenData.forEach(function(congressperson) {
            congressperson.headshot = moneyshot(congressperson);
          });

          setTimeout(newQuestion, 2000)
        });
      }

      function moneyshot(face) {
        var size = "225x275"; // "450x550"
        var id = face.person.bioguideid;
        return "https://theunitedstates.io/images/congress/"+size+"/"+id+".jpg";
      }

      // kick it all off
      fetchCongressmen(600);
    </script>
  </body>
</html>


<!-- {
 "description": "Representative for Illinois's 18th congressional district",
 "id": 43744,
 "party": "Republican",
 "person": {
  "name": "Rep. Darin LaHood [R-IL18]",
  "youtubeid": null
 },
 "state": "IL",
 "website": "https://lahood.house.gov/"
},  -->
